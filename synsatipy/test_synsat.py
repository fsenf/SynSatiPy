from synsat_test import SynSatTest
import numpy as np

def test_synsat_on_test_profile( accuracy = 1.):

    s = SynSatTest()
    s.run_workflow()

    target = np.array([[5.73808550e-02, 2.27539811e-01, 1.35243067e-01, 2.71376351e+02,
        2.31071751e+02, 2.48525205e+02, 2.65588312e+02, 2.67568685e+02,
        2.67310265e+02, 2.53160358e+02],
       [5.73817456e-02, 2.27556584e-01, 1.35235128e-01, 2.71479406e+02,
        2.32085280e+02, 2.49334519e+02, 2.65681963e+02, 2.67613130e+02,
        2.67387016e+02, 2.53553273e+02],
       [5.73826320e-02, 2.27573351e-01, 1.35227234e-01, 2.71586252e+02,
        2.33098733e+02, 2.50148545e+02, 2.65778029e+02, 2.67658487e+02,
        2.67464727e+02, 2.53953613e+02],
       [5.73835148e-02, 2.27590113e-01, 1.35219388e-01, 2.71697010e+02,
        2.34112110e+02, 2.50967155e+02, 2.65876542e+02, 2.67705102e+02,
        2.67543448e+02, 2.54361402e+02],
       [5.73843942e-02, 2.27606871e-01, 1.35211589e-01, 2.71811802e+02,
        2.35125409e+02, 2.51790224e+02, 2.65977534e+02, 2.67752442e+02,
        2.67623225e+02, 2.54776662e+02],
       [5.73852706e-02, 2.27623625e-01, 1.35203841e-01, 2.71930752e+02,
        2.36138630e+02, 2.52617629e+02, 2.66081035e+02, 2.67800834e+02,
        2.67704106e+02, 2.55199408e+02],
       [5.73861445e-02, 2.27640378e-01, 1.35196143e-01, 2.72053982e+02,
        2.37151773e+02, 2.53449251e+02, 2.66187078e+02, 2.67850325e+02,
        2.67786136e+02, 2.55629652e+02],
       [5.73870162e-02, 2.27657129e-01, 1.35188497e-01, 2.72181615e+02,
        2.38164837e+02, 2.54284975e+02, 2.66295694e+02, 2.67901328e+02,
        2.67869362e+02, 2.56067403e+02]])

    eps = np.abs( s.BtRefl - target ).max()
 
    assert eps < accuracy
